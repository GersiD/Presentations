\documentclass{beamer}

\usepackage{mpemath}
\usepackage{subcaption}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{pgf}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{natbib}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{bbm}


\usetikzlibrary{arrows,automata,backgrounds,positioning,decorations,intersections,matrix}

% *** Styles ***
\usetheme{Singapore}
\setbeamertemplate{navigation symbols}{}
% \usetheme[progressbar=frametitle]{metropolis}
% \usecolortheme{dolphin}
%\useinnertheme{circles}
%\usecolortheme{rose}
%\setbeamercovered{transparent}
\setbeamercovered{invisible}
\usefonttheme{professionalfonts}
%\usefonttheme[onlymath]{serif}
\setbeamertemplate{footline}[frame number]

\title{ROIL - Robust Offline Imitation Learning}
\author{Gersi Doko$^1$, Guang Yang$^2$, Daniel S. Brown$^2$, and Marek Petrik$^1$}
\institute{Department of Computer Science \\ $1$ University of New Hampshire \\ $2$ University of Utah}
\date{}

\AtBeginSection[]{
	\begin{frame}
          \vfill
	\centering
	% \usebeamerfont{title}
        {\huge\bf \insertsectionhead}%
	\vfill
\end{frame}
}

\begin{document}

\frame{\titlepage}

\section*{Intro}

% - 8 minutes!!! Less than 8 slides aim for 2 slides intros, 3 slides idea, 2 slides results, 1-slide conclusion
% - The basic idea
% - Pictures!
% - One point to drive home all most all methods rely on a good u_e hat
%   - We propose a general technique to avoid estimating U_e hat
%   - don't even show the LP (if you do make sure you don't rely on it to make your point)
% - [ ] separate the images for the results into different slides too busy in one slide

\begin{frame}
\frametitle{Why Imitation Learning?}
	\begin{itemize}
		\item Models are hard to specify
		\item Even harder to solve
		\item Often have access to expert demonstrations
		\item Usually don't have access to a simulator
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{This Talk}
	Computing policies that minimize worst case regret

	\vfill
	\emph{Key Idea}: Generate a convex set of consistent experts, then formulate and minimize regret
\end{frame}

\section*{ROIL}

\begin{frame}
	\frametitle{Our Approach}
	\textbf{Problem}: Find a policy $\pi$ that minimizes the regret with respect to the worst case expert consistent with the demonstrations $D_e$.
	\[ \rho(\tilde{\pi}, r) = \lim_{t \to \infty} \mathbb{E}^{\tilde{\pi}, \mathcal{P}} \lbrack \sum_{t=0}^T \gamma^t r(\tilde{s_t}, \tilde{\pi}(\tilde{s_t})) \rbrack \]
	\[ \min_{\pi \in \Pi} \max_{\pi_e \in \Pi} \max_{r \in \mathcal{R}} \rho(\pi_e, r) - \rho(\pi, r)\]
\end{frame}

\begin{frame}
\begin{figure}
  \begin{center}
  \begin{minipage}{0.45\linewidth}
    \centering
	\includegraphics[width=\textwidth]{../../pres_roil/plots/visual_U.pdf}

    \subcaption{Set of all Occupancy Frequencies}
  \end{minipage}
  \hspace{0.05\linewidth}
  \begin{minipage}{0.45\linewidth}
    \centering
	\includegraphics[width=\textwidth]{../../pres_roil/plots/visual_U_and_Upsilon.pdf}

    \subcaption{Set of consistent Occupancy Frequencies}
  \end{minipage}
  \end{center}
\caption{Visual Representation of the Sets $\mathcal{U}$ and $\Upsilon$}
\end{figure}

\end{frame}

\begin{frame}
	\begin{center}
		\includegraphics[width=\textwidth, height=\textheight]{../../pres_roil/plots/visual_solve_cheb.pdf}
	\end{center}
\end{frame}

\section*{Experiments}


\begin{frame}
\frametitle{40x40 Gridworld}

\begin{figure}
  \begin{center}
  \begin{minipage}{0.45\linewidth}
    \centering
    \includegraphics[width=\linewidth]{../../pres_roil/plots/returns/40x40_gridworld_on_policy_returns.pdf}
    \subcaption{On-Policy}
  \end{minipage}
  \hspace{0.05\linewidth}
  \begin{minipage}{0.45\linewidth}
    \centering
    \includegraphics[width=\linewidth]{../../pres_roil/plots/returns/40x40_gridworld_off_policy_returns.pdf}
    \subcaption{Off-Policy}
  \end{minipage}
  \end{center}
\caption{Returns of All Methods on 40x40 Gridworld}
\end{figure}
\end{frame}

\begin{frame}
\frametitle{Regret Comparison}

 \[ Regret(\pi) = \max_{\pi_e \in \Pi_R(D_e)} \max_{w \in \mathcal{W}} \rho(\pi_e, \Phi w) - \rho(\pi, \Phi w)\]

\begin{figure}
  \begin{center}
  \begin{minipage}{0.45\linewidth}
    \centering
    \includegraphics[width=\linewidth]{../../pres_roil/plots/regrets/40x40_gridworld_on_policy_regret_regrets.pdf}
    \subcaption{On-Policy}
  \end{minipage}
  \hspace{0.05\linewidth}
  \begin{minipage}{0.45\linewidth}
    \centering
    \includegraphics[width=\linewidth]{../../pres_roil/plots/regrets/40x40_gridworld_off_policy_regret_regrets.pdf}
    \subcaption{Off-Policy}
  \end{minipage}
  \end{center}
\caption{Regret of All Methods on 40x40 Gridworld}
\end{figure}

\end{frame}

\section*{Conclusion}

\begin{frame}
	\frametitle{Conclusion}
	\begin{itemize}
		\item We propose ROIL, which avoids estimating the experts' occupancy frequency.
		\item We show that our approach outperforms existing methods in environments with high covariate shift.
		\item ROIL is guaranteed to find a policy that minimizes the worst case regret.
	\end{itemize}
\end{frame}


\end{document} 

